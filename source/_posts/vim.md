---
title: vim文本编辑
top: false
cover: false
toc: true
mathjax: true
date: 2019-09-27 17:33:14
password:
summary:
tags: Linux
categories:
---

### vim编辑器
---
##### 文本编辑器：
- 纯文本, ASCII text，Unicode

##### 文本编辑器种类：
- 行编辑器：sed
- 全屏编辑器：nano，vi，vim
    
##### vim：模式化的编辑器
##### 基本模式： 
- 编辑模式 or 命令模式
- 输入模式
- 末行模式

##### vim打开文件

```
vim [options][file...]
    +#: 打开文件后，直接让光标处于第#行的行首
    +/PATTERN: 打开文件后，直接让光标处于第一个被PATTERN匹配到的行的行首
    +： 光标处于尾行行首
e.g.
  vim +5 /etc/fstab
  vim +/dev /etc/fstab
  vim + /etc/profile
```

##### vim模式转换

- 命令行模式为默认模式
- 由命令行模式进入输入模式：

```
i：insert,在光标所在处输入
a：append,在光标所在后输入
o：在光标所在处下方打开一个新行
I: 在光标所在行的行首输入
A: 在光标所在行的行尾输入
O: 在光标所在处的上方打开一个新行
```
- 输入模式进入命令行模式：ESC
- 命令行模式进入末行模式：冒号 :

##### vim关闭文件

```
ZZ:保存并退出
:q  退出
:q! 强制退出，不保存
:wq 保存并退出
:x  保存并退出
:w /PATH/TO/SOMEWHERE  保存到另一个文件中（另存为）
```
##### vim光标跳转
- 字符间跳转

```
h:左  j:下  k:上  l:右
```

- 单词间跳转

```
w:下一个单词的词首
e:当前或后一个单词的词尾
b:当前或前一个单词的词首

#COMMAND: 跳转由#指定的个数的单词
```

- 行首行尾跳转

```
^: 跳转到行首的第一个非空白字符
0: 跳转至绝对行首
$: 跳转至行尾
```

 
- 行间跳转

```
gg：跳转至文件第一行
G：跳转至文件最后一行
#G：跳转至由#指定的行
```

- 句间跳转

```
(
)
```

- 段间跳转

```
{
}
```
##### vim翻屏操作

```
ctrl + f ： 向文件尾部翻一屏
ctrl + b ： 向文件首部翻一屏
ctrl + d ： 向文件尾部翻半屏
ctrl + u ： 向文件首部翻半屏
```

##### vim的编辑命令(命令行模式)
- 字符编辑

```
x:  删除光标所在处的字符
#x: 删除光标所在处起始的#个数的字符
```

- 替换命令

```
r:   替换光标所在处的字符
```

- 删除命令
  
```
d:  删除命令
d$: 删除当前光标所在处到行尾
d^: 删除当前光标所在处到行首
dd：删除当前光标所在的行
#dd： 删除光标所处的行起始的共#行

```

- 粘贴命令

```
p
```

- 复制命令

```
yy

#yy  复制#行

```
- 改变命令，删除操作后 由命令行模式进入输入模式

```
cc,c$,c^,c0,cb,ce,cw
```


- 可视化模式：

```
v： 按字符选择拟定
V： 按行选定

结合编辑命令： d，c，y
```
 
- 撤销操作

```
u
#u： 撤销此前的#个操作

ctrl + r： 撤销此前的撤销
```

- 重复执行前一个编辑操作: 点号 .



##### vim的练习手册

```
vimtutor
```

##### vim末行模式

```
末行模式的帮助信息
:help
:help set
```


- 地址定界
 
```
:start_pos[,end_pos]
#:特定的第#行，例如5即第5行
#,#: 指定行范围，左侧为起始行，右侧为结束行
#，+#: 指定行范围，左侧为起始行绝对编号，右侧为相对左侧行号的偏移量
.: 当前行
$: 最后一行
%: 全文
/pattern/: 从光标所在处起始向文件尾部第一次被模式所匹配到的行
/pat1/,/pat2/: pat1到pat2之间的行

可同编辑命令一同使用，实现编辑操作： d,y,c,p,w /path/to/somefile
                                 r /path/from/somefile
                                    

e.g.
:5,+1w /tmp/test.txt
:5r /tmp/test.txt
:5,8d
```

- 查找

```
/pattern: 查找当前光标所在处向文件尾部查找能够被当年模式匹配到的所有字符串
?pattern: 从当前光标所在处向文件首部查找能够被当前模式匹配到的所有字符串
n： 下一个，与命令方向相同
N:  上一个，与命令方向相反
```
- 查找并替换

```
s/要查找的内容/替换为的内容/修饰符
要查找的内容可使用正则表达式
替换为的内容不能使用正则表达式，但可以引用，\1 \2等

修饰符：
 i：忽略大小写
 g：全局替换
 
e.g.
:%s/222/333/g
:5,6s/222/333/g
:1.20s/this/THIS/gi
:10,12s@^@#&@    行首加井号，&用于引用匹配到的被替换的内容
等同于
:10,12s@^@#\1@


可将分隔符替换为其他非常用字符，避免查找和替换的内容中有/需转义的问题
s@@@
s###
```

##### vim的多文件功能

```
vim file1 file2 file3
支持不同文件之间的编辑命令操作

:next 下一个文件 
:prev 前一个文件
:first 第一个
:last  最后一个
:wqall 保存所有文件并退出
:wall
:qall
```

```
多窗口机制
-o: 水平分割窗口 
-O: 垂直分割窗口
vim -o fstab fstab.new grep.txt

ctrl + w: 窗口切换

ctrl + w,s: 水平分割窗口
ctrl + w,v: 垂直分割窗口
```

##### 定制vim的工作特性

- 行号
```
:set nu   显示行号
:set nonu 取消显示行号
永久生效将set nu 写入配置文件
用户家目录下创建.vimrc即为vim的配置文件
```
- 自动缩进功能
```
:set ai
:set noai
```
- 搜索结果高亮显示
```
:set hlsearch
:set nohlsearch
```
- 语法高亮
```
:syntax on
:syntax off
```
- 忽略字符大小写
```
:set ic
:set noic
```
